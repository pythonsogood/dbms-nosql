{% extends "base.html" %}

{% block content %}
<div class="container py-5">
    <h2 class="fw-bold mb-5">Your Shopping Bag</h2>

    <div class="row g-5">
        <div class="col-lg-8">
            {% if request.user_cart|length > 0 %}
				<div class="table-responsive">
					<table class="table align-middle">
						<thead class="text-uppercase small text-muted border-0">
							<tr>
								<th scope="col" style="width: 50%;">Product</th>
								<th scope="col">Price</th>
								<th scope="col">Quantity</th>
								<th scope="col" class="text-end">Total</th>
							</tr>
						</thead>
						<tbody class="border-top-0">
							{% for item in request.user_cart %}
								<tr>
									<td class="py-4">
										<div class="d-flex align-items-center">
											<img src="{{ item.product.image_url }}" alt="{{ item.name }}" class="rounded me-3"
												width="80" height="100" style="object-fit: cover;">
											<div>
												<h6 class="mb-1 fw-bold">{{ item.product.name }}</h6>
												<small class="text-muted">Size: {{ item.size }}</small><br>
												<button
													class="btn btn-link text-danger small text-decoration-underline p-0 border-0"
													onclick="removeFromCart('{{ item.product.id }}', '{{ item.size }}')">Remove</button>
											</div>
										</div>
									</td>
									<td>${{ item.product.price }}</td>
									<td>
										<input type="number" class="form-control form-control-sm w-50 text-center" value="{{ item.quantity }}" min="1" max="{{ item.product.stock }}" onchange="cartItemQuantityChange(this, '{{ item.product.id }}', '{{ item.size }}')">
									</td>
									<td class="text-end fw-bold">${{ item.product.price * item.quantity }}</td>
								</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
            {% else %}
				<div class="text-center py-5 bg-light rounded">
					<h4 class="text-muted">Your bag is empty.</h4>
					<a href="/shop" class="btn btn-outline-dark mt-3">Continue Shopping</a>
				</div>
            {% endif %}
        </div>

        <div class="col-lg-4">
            <div class="bg-light p-4 rounded shadow-sm">
                <h5 class="fw-bold mb-4">Order Summary</h5>
                <div class="d-flex justify-content-between mb-2">
                    <span class="text-muted">Subtotal</span>
                    <span>${{ total_price }}</span>
                </div>
                <div class="d-flex justify-content-between mb-2">
                    <span class="text-muted">Shipping</span>
                    <span>Calculated at checkout</span>
                </div>
                <hr>
                <div class="d-flex justify-content-between mb-4">
                    <span class="fw-bold fs-5">Total</span>
                    <span class="fw-bold fs-5">${{ total_price }}</span>
                </div>
                <button class="btn btn-red w-100 py-3 text-uppercase fw-bold">Proceed to Checkout</button>
            </div>
        </div>
    </div>
</div>
</div>
{% endblock %}